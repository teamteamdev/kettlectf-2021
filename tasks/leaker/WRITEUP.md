# Leaker: Write-up

Нам дана прошивка от ардуино, которая вероятно передавала данные, моргая
светодиодами. Погуглив, понимаем, что у ардуино архитектура AVR.

Дизассемблируем чем-нибудь, что хорошо работает с AVR. Например, ODA. Если
прошивка распозналась как данные, принудительно указываем, что это код.

В начале прошивки идёт загрузчик, он нам не особо интересен. Потом идёт
инициализация, и затем уже рабочий цикл. Попробуем его найти.

Заметим, что ближе к концу кода вызываются преимущественно две функции, от
разных аргументов. Вероятно, это и есть моргание светодиодами.

Одна из функций принимает 2 аргумента. Один из них имеет значения 0 и 1, а
другой - от 1 до 7 (ну и там в самом начале ещё 1 раз принимает значение 0)
Похоже, что первый аргумент определяет состояние светодиода, а второй - номер
порта Вторая функция почти всегда вызывается от 4 аргументов (100, 0, 0, 0),
вероятно, это задержка между морганиями.

В самом начале (вероятно, на инициализации) во все порты записывается 0. В
начале цикла 1 записывается в те позиции, в которых стоит единица в двоичном
представлении ascii кода символа k.

Дальше каждый раз после задержки некоторые светодиоды переключаются, образовывая
новую букву. После t в слове kettle функция задержки вызывается от (200, 0, 0,
0), что ещё раз подтверждает наши предположения (букв t 2 подряд, переключаться
между ними не нужно, поэтому задержки после каждой буквы объединили в одну
общую)

Таким образом, последовательно меняя состояния 8 светодиодов, мы получим ascii
коды всех символов флага

В самом конце цикла все горящие светодиоды выключаются, а функция задержки
вызывается уже с двумя ненулевыми аргументами (но можно заметить, что это просто
младший и старший байт числа 1000).

Флаг: **kettle_4rdu1n0_45m_15_h4rdrD**