# Коммерческая тайна...: Write-up

Скачиваем архив и распаковываем его. Видим .exe файл, запускаем его.
Открывается игра на unity. На стартовом экране у нас просят токен доступа,
про который говорилось в условии задачи и про который мы ничего не знаем. 
<img src="writeup/Game1.png">
Пробуя ввести что либо наблюдаем как изменяется значение "процентов совпадения токена".
Наблюдая изменения можно сказать что значение меняется абсолютно случайно, но никогда не достигает 100%.
Под полем для ввода есть кнопка, которая инициирует проверку безопасности, которую мы не проходим.
<img src="writeup/Game2.png">
<img src="writeup/Game3.png">
Становится ясно, что чтобы пройти проверку нужно сделать так, чтобы процент совпадения токена стал равен 100%.
Попробуем найти это значение в оперативной памяти и изменить его. Например, с помощью CheatEngine.
По неизвестной причине найти его не получается.
Так как игра сделана на Unity, ее код написан на C#, попробуем декомпилировать.
Декомпиляция проходит успешно, теперь нужно найти скрипт, который делает проверку безопасности.
<img src="writeup/Game0.png">
Наше внимание привлекает скрипт с названием SecurityChecker, откроем его.
И вот мы видим код, проверяющий безопасность.
Видим, что есть условие, что если некое значение _securityValue будет равно 100, то проверка пройдет.
Но используется методы Encrypt и Decrypt, которые как то меняют значение, посмотрим их содержимое.
Наконец то мы видим причину, по которой не могли найти значения с самого начала,
перед записью нового значения код умножает его на 2 и вычитает 1!
При отображении значения происходит обратная операция.
Стало понятно, что чтобы найти значение мы должны менять его по той же формуле.
Пробуем, находим нужный адрес в оперативной памяти, теперь нужно поменять его на сто,
не забыв применить ранее найденную формулу.
По формуле получаем 100 * 2 - 1 = 199, это значение и записываем.
Пробуем ввести что-нибудь в поле для ввода, 
отображается значение 100%. 
Проверка безопасности проходит, запускается симуляция рабочего стола с открытым терминалом linux, в котором введен флаг.
<img src="writeup/Game4.png">
<img src="writeup/Game5.png">
<img src="writeup/Game6.png">

Флаг: **kettle_never_do_important_things_on_client_machine**